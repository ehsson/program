#include <stdio.h>

int arr[100001][3];
int temp[100001];

int main(void)
{
	int T, N;
	int min, max;
	FILE* pf;
	freopen_s(&pf, "input.txt", "r", stdin);

	scanf_s("%d", &T);

	for (int TC = 1; TC <= T; TC++)
	{
		scanf_s("%d", &N);

		for (int n = 1; n <= N; n++)
			scanf_s("%d", &arr[n][0]);

		arr[1][1] = 1;

		for (int i = 2; i <= N; i++)
			arr[i][1] = arr[i - 1][0] >= arr[i - 1][1] ? arr[i - 1][1] + 1 : arr[i - 1][0] + 1;

		arr[N][2] = 1;
		max = 0;

		for (int j = N - 1; j >= 0; j--)
		{
			min = 100000000;

			for (int k = 0; k < 3; k++)
			{
				if (min > arr[j + 1][k])
				{
					min = arr[j + 1][k];

					temp[j + 1] = min;
				}
			}

			arr[j][2] = min + 1;
		}

		for (int m = 1; m <= N; m++)
			if (max < temp[m])
				max = temp[m];

		printf("Case #%d\n%d\n", TC, max);
	}

	return 0;
}
