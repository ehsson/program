#include <stdio.h>
#include <stdlib.h>

int arr[101][101][12] = { 0 };

int M, N, K;
int min, n;

void DFS(int x, int y, int water, int height, int prev_height)
{
	if (x > M || y > N)
		return;

	if (arr[y][x][11] < 0 && water < K)
		water++;

	height += abs(abs(prev_height) - abs(arr[y][x][11]));

	if (arr[y][x][water] <= height)
		return;

	if (water >= K)
		arr[y][x][K] = height;
	else
		arr[y][x][water] = height;

	if (x == M && y == N)
		min = arr[y][x][K];

	DFS(x + 1, y, water, height, arr[y][x][11]);

	DFS(x, y + 1, water, height, arr[y][x][11]);
}

int main(void)
{
	int T;
	FILE* pf;
	freopen_s(&pf, "input.txt", "r", stdin);

	scanf_s("%d", &T);

	for (int t = 1; t <= T; t++)
	{
		scanf_s("%d %d %d", &M, &N, &K);

		for (int n = 0; n <= N; n++)
			for (int m = 0; m <= M; m++)
			{
				scanf_s("%d", &arr[n][m][11]);
				for (int i = 0; i <= K; i++)
					arr[n][m][i] = 200 * 100;
			}

		min = 200 * 100;

		DFS(0, 0, 0, 0, arr[0][0][11]);

		printf("Case #%d\n%d\n", t, min);
	}

	return 0;
}

//time limit code

#include <stdio.h>
#include <math.h>

#define min(a, b) a < b ? a : b

int arr[101][101][12];
int chk[101][101][12];

int M, N, K;

void DFS(int y, int x, int water, int prev_y, int prev_x, int prev_water)
{
	if (y > N || x > M)
		return;

	if (arr[y][x][11] < 0 && water < K)
		water++;

	chk[y][x][water] += abs(abs(arr[y][x][11]) - abs(arr[prev_y][prev_x][11])) 
		+ chk[prev_y][prev_x][prev_water];

	if (min(arr[y][x][water], chk[y][x][water]) == arr[y][x][water])
	{
		chk[y][x][water] -= abs(abs(arr[y][x][11]) - abs(arr[prev_y][prev_x][11]))
			+ chk[prev_y][prev_x][prev_water];
		return;
	}
	else
		arr[y][x][water] = min(arr[y][x][water], chk[y][x][water]);

	if (y == N && x == M)
	{
		chk[y][x][water] -= abs(abs(arr[y][x][11]) - abs(arr[prev_y][prev_x][11]))
			+ chk[prev_y][prev_x][prev_water];

		return;
	}

	DFS(y, x + 1, water, y, x, water);

	DFS(y + 1, x, water, y, x, water);

	chk[y][x][water] -= abs(abs(arr[y][x][11]) - abs(arr[prev_y][prev_x][11]))
		+ chk[prev_y][prev_x][prev_water];
}

int main(void)
{
	FILE* pf;
	freopen_s(&pf, "input.txt", "r", stdin);
	int T;

	scanf_s("%d", &T);

	for (int t = 1; t <= T; t++)
	{
		scanf_s("%d %d %d", &M, &N, &K);

		for (int n = 0; n <= N; n++)
			for (int m = 0; m <= M; m++)
			{
				scanf_s("%d", &arr[n][m][11]);

				chk[n][m][11] = arr[n][m][11];

				for (int k = 0; k <= K; k++)
				{
					arr[n][m][k] = 200 * 100;
					chk[n][m][k] = 0;
				}
			}

		DFS(0, 0, 0, 0, 0, 0);

		printf("Case #%d\n%d\n", t, arr[N][M][K]);
	}

	return 0;
}

// test case

4
3 1 1
10 -12 10 8
-15 -14 -11 11
3 1 3
10 -12 10 8
-15 -14 -11 11
5 3 2
10 12 9 15 20 17
15 -20 24 54 -45 10
9 33 32 -89 -37 67
54 -34 29 -56 35 24 
6 4 3
12 23 34 -45 67 -78 89
23 -45 78 -34 56 -31 10
-54 -87 90 -12 34 54 -65
45 -89 23 -45 -77 22 89 
34 83 -91 -23 48 56 34
